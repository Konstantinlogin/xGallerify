"use strict";!function(e){function i(i,o){o.jsSetup&&t(i,o.margin),i.addClass("xgallerify"),u?n(i,o):e(window).on("load",function(){n(i,o)}),e(window).resize(function(){n(i,o)})}function t(i,t){var n=e(i.children());n.css("display","inline-block").css("margin",t).find("img").css("width","100%").addClass("ximage-loaded")}function n(i,t){var n,a=[],s=[],h=i.children(),u=t.width||i.width(),m=d(u,t.mode),l=t.imagesPerRow||m.itemsPerRow;t.width&&i.width(u);for(var c=0;c<h.length;c++){var g=e(h[c]);g.width()&&(a.push(g),(a.length>=l||c==h.length-1)&&(s.push(a),c==h.length-1&&a.length<m.itemsPerRow&&"fullwidth"!=t.lastRow?r(s[s.length-1],u,t.margin,n):n=o(s[s.length-1],u,t.margin,m.maxHeight),n<m.maxHeight&&(a=[])))}}function o(e,i,t,n){return a(e,n),s(e,i,t)}function r(i,t,n,o){o=a(i,o);var r=0;return e(i).each(function(){r+=e(this).width()}),r>t&&(o=s(i,t,n)),o}function a(e,i){for(var t=0;t<e.length;t++){var n=i/e[t].height();e[t].width(e[t].width()*n)}return e[0].height()}function s(i,t,n){var o=0;e(i).each(function(){o+=e(this).width()});for(var r=(t-i.length*(n+4)*2)/o,a=0;a<i.length;a++)i[a].css("width",i[a].width()*r);return i[0].height()}function d(e,i){var t={itemsPerRow:void 0,maxHeight:void 0};return 768>=e&&(t.maxHeight=screen.height),"bootstrap"==i?(e>1200?t.itemsPerRow=4:e>992?t.itemsPerRow=3:e>768?t.itemsPerRow=2:t.itemsPerRow=.4,e>768&&(t.maxHeight=.5*screen.height)):"flickr"==i?(e>1800?t.itemsPerRow=4:e>1300?t.itemsPerRow=3:e>610?t.itemsPerRow=2:t.itemsPerRow=1,e>768&&(t.maxHeight=.4*screen.height)):"small"==i?(e>1800?t.itemsPerRow=14:e>1300?t.itemsPerRow=10:e>610?t.itemsPerRow=6:t.itemsPerRow=4,e>768&&(t.maxHeight=.4*screen.height)):(e>1800?t.itemsPerRow=4:e>1200?t.itemsPerRow=3:e>768?t.itemsPerRow=2:t.itemsPerRow=1,e>768&&(t.maxHeight=.5*screen.height)),t}function h(e,i,t){var n;return function(){var o=this,r=arguments,a=function(){n=null,t||e.apply(o,r)},s=t&&!n;clearTimeout(n),n=setTimeout(a,i),s&&e.apply(o,r)}}var u=!1;e(window).load(function(){u=!0}),e.fn.gallerify=function(e){var o=this;e=e||{},e.margin=void 0!==e.margin&&null!==e.margin?e.margin:10,e.width=e.width||void 0,e.mode=e.mode||"default",e.jsSetup=void 0!==e.jsSetup&&null!==e.jsSetup?e.jsSetup:!0,e.imagesPerRow=e.imagesPerRow||void 0,e.debounceLoad=void 0!==e.debounceLoad&&null!==e.debounceLoad?e.debounceLoad:!0,e.debounceTime=void 0!==e.debounceTime&&null!==e.debounceTime?e.debounceTime:50,e.lastRow=e.lastRow||"adjust",i(o,e),this.gallerify.render=function(){t(o,e.margin),n(o,e)};var r=h(function(){n(o,e)},e.debounceTime);return this.gallerify.renderAsyncImages=function(){t(o,e.margin),e.debounceLoad?o.find("img").load(function(){r()}):o.find("img").load(function(){n(o,e)})},o}}(jQuery);