!function(e){function i(i,n){!n.interruptSetup&&t(i,n.margin),i.addClass("xgallerify"),w?r(i,n):e(window).on("load",function(){r(i,n)}),e(window).resize(function(){r(i,n)})}function t(i,t){jChildren=e(i.children()),jChildren.css("display","inline-block").css("margin",t).find("img").css("width","100%").addClass("ximage-loaded")}function r(i,t){var r=[],h=[],s=i.children(),w=t.width||i.width(),m=a(w,t.mode);imagesPerRow=t.imagesPerRow||m.itemsPerRow,t.lastRow=t.lastRow||"fullwidth";var g;t.width&&i.width(w);for(var d=0;d<s.length;d++){var l=e(s[d]);r.push(l),(r.length>=imagesPerRow||d==s.length-1)&&(h.push(r),d==s.length-1&&r.length<m.itemsPerRow&&"fullwidth"!=t.lastRow?o(h[h.length-1],w,t.margin,g):g=n(h[h.length-1],w,t.margin,m.maxHeight),g<m.maxHeight&&(r=[]))}}function n(e,i,t,r){return h(e,r),s(e,i,t)}function o(i,t,r,n){n=h(i,n);var o=0;return e(i).each(function(){o+=e(this).width()}),o>t&&(n=s(i,t,r)),n}function h(e,i){for(var t=0;t<e.length;t++){var r=i/e[t].height();e[t].width();e[t].width(e[t].width()*r)}return e[0].height()}function s(i,t,r){var n=0;e(i).each(function(){n+=e(this).width()});for(var o=(t-i.length*(r+4)*2)/n,h=0;h<i.length;h++)i[h].css("width",i[h].width()*o);return i[0].height()}function a(e,i){var t={itemsPerRow:void 0,maxHeight:void 0};return 768>=e&&(t.maxHeight=screen.height),"bootstrap"==i?(e>1200?t.itemsPerRow=4:e>992?t.itemsPerRow=3:e>768?t.itemsPerRow=2:t.itemsPerRow=.4,e>768&&(t.maxHeight=.5*screen.height)):"flickr"==i?(e>1800?t.itemsPerRow=4:e>1300?t.itemsPerRow=3:e>610?t.itemsPerRow=2:t.itemsPerRow=1,e>768&&(t.maxHeight=.4*screen.height)):"small"==i?(e>1800?t.itemsPerRow=14:e>1300?t.itemsPerRow=10:e>610?t.itemsPerRow=6:t.itemsPerRow=4,e>768&&(t.maxHeight=.4*screen.height)):(e>1800?t.itemsPerRow=4:e>1200?t.itemsPerRow=3:e>768?t.itemsPerRow=2:t.itemsPerRow=1,e>768&&(t.maxHeight=.6*screen.height)),t}var w=!1;e(window).load(function(){w=!0}),e.fn.gallerify=function(e){var t=this;return e=e||{},e.margin=void 0!=e.margin&&null!=e.margin?e.margin:5,e.width=e.width||void 0,e.mode=e.mode||"default",e.interruptSetup=e.interruptSetup||!1,e.imagesPerRow=e.imagesPerRow||void 0,i(t,e),this.gallerify.render=function(){r(t,e)},this.gallerify.renderAsyncImages=function(){t.find("img").load(function(){r(t,e)})},t}}(jQuery);