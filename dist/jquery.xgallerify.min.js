!function(e){function i(i,r){!r.interruptSetup&&t(i,r.margin),i.addClass("xgallerify"),w?n(i,r):e(window).on("load",function(){n(i,r)}),e(window).resize(function(){n(i,r)})}function t(i,t){jChildren=e(i.children()),jChildren.css("display","inline-block").css("margin",t).find("img").css("width","100%").addClass("ximage-loaded")}function n(i,t){var h=[],s=[],w=i.children(),m=t.width||i.width(),d=a(m,t.mode);imagesPerRow=t.imagesPerRow||d.itemsPerRow,t.lastRow=t.lastRow||"fullwidth";var g;t.width&&i.width(m);for(var l=0;l<w.length;l++){var u=e(w[l]);u.width()>0?(h.push(u),(h.length>=imagesPerRow||l==w.length-1)&&(s.push(h),l==w.length-1&&h.length<d.itemsPerRow&&"fullwidth"!=t.lastRow?o(s[s.length-1],m,t.margin,g):g=r(s[s.length-1],m,t.margin,d.maxHeight),g<d.maxHeight&&(h=[]))):u.load(function(){n(_this,params)})}}function r(e,i,t,n){return h(e,n),s(e,i,t)}function o(i,t,n,r){r=h(i,r);var o=0;return e(i).each(function(){o+=e(this).width()}),o>t&&(r=s(i,t,n)),r}function h(e,i){for(var t=0;t<e.length;t++){var n=i/e[t].height();e[t].width();e[t].width(e[t].width()*n)}return e[0].height()}function s(i,t,n){var r=0;e(i).each(function(){r+=e(this).width()});for(var o=(t-i.length*(n+4)*2)/r,h=0;h<i.length;h++)i[h].css("width",i[h].width()*o);return i[0].height()}function a(e,i){var t={itemsPerRow:void 0,maxHeight:void 0};return 768>=e&&(t.maxHeight=screen.height),"bootstrap"==i?(e>1200?t.itemsPerRow=4:e>992?t.itemsPerRow=3:e>768?t.itemsPerRow=2:t.itemsPerRow=.4,e>768&&(t.maxHeight=.5*screen.height)):"flickr"==i?(e>1800?t.itemsPerRow=4:e>1300?t.itemsPerRow=3:e>610?t.itemsPerRow=2:t.itemsPerRow=1,e>768&&(t.maxHeight=.4*screen.height)):"small"==i?(e>1800?t.itemsPerRow=14:e>1300?t.itemsPerRow=10:e>610?t.itemsPerRow=6:t.itemsPerRow=4,e>768&&(t.maxHeight=.4*screen.height)):(e>1800?t.itemsPerRow=4:e>1200?t.itemsPerRow=3:e>768?t.itemsPerRow=2:t.itemsPerRow=1,e>768&&(t.maxHeight=.6*screen.height)),t}var w=!1;e(window).load(function(){w=!0}),e.fn.gallerify=function(e){var t=this;return e=e||{},e.margin=void 0!=e.margin&&null!=e.margin?e.margin:5,e.width=e.width||void 0,e.mode=e.mode||"default",e.interruptSetup=e.interruptSetup||!1,e.imagesPerRow=e.imagesPerRow||void 0,i(t,e),this.gallerify.render=function(){n(t,e)},this.gallerify.renderAsyncImages=function(){console.log(this),t.find("img").load(function(){n(t,e)})},t}}(jQuery);