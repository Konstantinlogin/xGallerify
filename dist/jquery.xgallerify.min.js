!function(e){window.readyForGallerify=!1,e(window).load(function(){window.readyForGallerify=!0}),e.fn.gallerify=function(i){function t(e){var t={itemsPerColumn:-1,maxHeight:500};return"default"==i.mode?(e>1800?t.itemsPerColumn=4:e>1200?t.itemsPerColumn=3:e>768?t.itemsPerColumn=2:t.itemsPerColumn=1,e>768&&(t.maxHeight=.6*screen.height)):"bootstrap"==i.mode?(e>1200?t.itemsPerColumn=4:e>992?t.itemsPerColumn=3:e>768?t.itemsPerColumn=2:t.itemsPerColumn=.4,e>768&&(t.maxHeight=.5*screen.height)):"flickr"==i.mode?(e>1800?t.itemsPerColumn=4:e>1300?t.itemsPerColumn=3:e>610?t.itemsPerColumn=2:t.itemsPerColumn=1,e>768&&(t.maxHeight=.4*screen.height)):"small"==i.mode&&(e>1800?t.itemsPerColumn=14:e>1300?t.itemsPerColumn=10:e>610?t.itemsPerColumn=6:t.itemsPerColumn=4,e>768&&(t.maxHeight=.4*screen.height)),768>e&&(t.maxHeight=screen.height),t}function n(i,t,n){var r=0;e(i).each(function(){r+=e(this).width()});for(var o=(t-i.length*(n+4)*2)/r,m=0;m<i.length;m++)i[m].css("width",i[m].width()*o);return i[0].height()}function r(e,i){for(var t=0;t<e.length;t++){var n=i/e[t].height();e[t].width();e[t].width(e[t].width()*n)}return e[0].height()}function o(e,i,t,o){var m=o;return m=r(e,m),m=n(e,i,t)}function m(i,t,o,m){m=r(i,m);var a=0;return e(i).each(function(){a+=e(this).width()}),a>t&&(m=n(i,t,o)),m}function a(n,r){var l=[],h=[],u=n.children(),d=r.width||n.width(),g=t(d);imagesPerRow=r.imagesPerRow||g.itemsPerColumn,console.log(r),r.margin=void 0!=r.margin?r.margin:10,r.lastRow=r.lastRow||"fullwidth";var w;r.width&&n.width(d),n.css("font-size",0);for(var f=0;f<u.length;f++){var c=e(u[f]);if(c.width()>0){if(l.push(c),c.css("margin",r.margin),l.length>=imagesPerRow||f==u.length-1){var P=f==u.length-1&&l.length<g.itemsPerColumn;h.push(l),P?"fullwidth"==r.lastRow?w=o(h[h.length-1],d,r.margin,g.maxHeight):"adjust"==r.lastRow&&m(h[h.length-1],d,r.margin,w):w=o(h[h.length-1],d,r.margin,g.maxHeight),w<g.maxHeight&&(l=[])}}else c.load(function(){a(s,i),e(this).addClass("imgloaded")})}}function l(i){for(var t=i.children(),n=0;n<t.length;n++){var r=e(t[n]);r.css("display","inline-block"),r.find("img").css("width","100%")}}function h(){!i.interruptSetup&&l(s),window.readyForGallerify?a(s,i):e(window).on("load",function(){a(s,i)}),e(window).resize(function(){a(s,i)})}var s=this;return i.interruptSetup=i.interruptSetup||!1,i.width=i.width||void 0,i.imagesPerRow=i.imagesPerRow||void 0,i.margin=void 0!=i.margin?i.margin:void 0,i.mode=i.mode||"default",h(),s.reinit=function(){a(s,i)},s}}(jQuery);