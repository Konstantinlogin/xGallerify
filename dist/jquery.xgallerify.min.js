!function(e){var i=!1;e(window).load(function(){i=!0}),e.fn.gallerify=function(t){function n(e){var i={itemsPerRow:void 0,maxHeight:void 0};return 768>=e&&(i.maxHeight=screen.height),"bootstrap"==t.mode?(e>1200?i.itemsPerRow=4:e>992?i.itemsPerRow=3:e>768?i.itemsPerRow=2:i.itemsPerRow=.4,e>768&&(i.maxHeight=.5*screen.height)):"flickr"==t.mode?(e>1800?i.itemsPerRow=4:e>1300?i.itemsPerRow=3:e>610?i.itemsPerRow=2:i.itemsPerRow=1,e>768&&(i.maxHeight=.4*screen.height)):"small"==t.mode?(e>1800?i.itemsPerRow=14:e>1300?i.itemsPerRow=10:e>610?i.itemsPerRow=6:i.itemsPerRow=4,e>768&&(i.maxHeight=.4*screen.height)):(e>1800?i.itemsPerRow=4:e>1200?i.itemsPerRow=3:e>768?i.itemsPerRow=2:i.itemsPerRow=1,e>768&&(i.maxHeight=.6*screen.height)),i}function r(i,t,n){var r=0;e(i).each(function(){r+=e(this).width()});for(var o=(t-i.length*(n+4)*2)/r,h=0;h<i.length;h++)i[h].css("width",i[h].width()*o);return i[0].height()}function o(e,i){for(var t=0;t<e.length;t++){var n=i/e[t].height();e[t].width();e[t].width(e[t].width()*n)}return e[0].height()}function h(e,i,t,n){return o(e,n),r(e,i,t)}function a(i,t,n,h){h=o(i,h);var a=0;return e(i).each(function(){a+=e(this).width()}),a>t&&(h=r(i,t,n)),h}function s(i,r){console.log("rendering");var o=[],d=[],m=i.children(),g=r.width||i.width(),l=n(g);imagesPerRow=r.imagesPerRow||l.itemsPerRow,r.lastRow=r.lastRow||"fullwidth";var u;r.width&&i.width(g);for(var c=0;c<m.length;c++){var f=e(m[c]);f.width()>0?(o.push(f),(o.length>=imagesPerRow||c==m.length-1)&&(d.push(o),c==m.length-1&&o.length<l.itemsPerRow&&"fullwidth"!=r.lastRow?a(d[d.length-1],g,r.margin,u):u=h(d[d.length-1],g,r.margin,l.maxHeight),u<l.maxHeight&&(o=[]))):f.load(function(){s(w,t)})}}function d(i){jChildren=e(i.children()),jChildren.css("display","inline-block").css("margin",t.margin).find("img").css("width","100%").addClass("ximage-loaded")}function m(){!t.interruptSetup&&d(w),w.addClass("xgallerify"),i?s(w,t):e(window).on("load",function(){s(w,t)}),e(window).resize(function(){s(w,t)})}var w=this;return t.mode=t.mode||"default",t.interruptSetup=t.interruptSetup||!1,t.width=t.width||void 0,t.imagesPerRow=t.imagesPerRow||void 0,t.margin=void 0!=t.margin&&null!=t.margin?t.margin:5,w.gallerify.render=function(){s(w,t)},w.gallerify.renderAsyncImages=function(){w.find("img").load(function(){s(w,t)})},m(),w}}(jQuery);