window.readyForGallerify=!1,$(window).load(function(){window.readyForGallerify=!0}),$.fn.gallerify=function(e){function i(i){var t={itemsPerColumn:-1,maxHeight:500};return"default"==e.mode?(i>1800?t.itemsPerColumn=4:i>1200?t.itemsPerColumn=3:i>768?t.itemsPerColumn=2:t.itemsPerColumn=1,i>768&&(t.maxHeight=.6*screen.height)):"bootstrap"==e.mode?(i>1200?t.itemsPerColumn=4:i>992?t.itemsPerColumn=3:i>768?t.itemsPerColumn=2:t.itemsPerColumn=.4,i>768&&(t.maxHeight=.5*screen.height)):"flickr"==e.mode&&(i>1800?t.itemsPerColumn=4:i>1300?t.itemsPerColumn=3:i>610?t.itemsPerColumn=2:t.itemsPerColumn=1,i>768&&(t.maxHeight=.4*screen.height)),768>i&&(t.maxHeight=screen.height),t}function t(e,i,t){for(var n=_.reduce(e,function(e,i){return e+i.width()},0),r=(i-1-e.length*(t+4)*2)/n,o=0;o<e.length;o++)e[o].css("width",e[o].width()*r);return e[0].height()}function n(e,i){for(var t=0;t<e.length;t++){var n=i/e[t].height();e[t].width();e[t].width(e[t].width()*n)}}function r(e,i,r,o){var a=o;n(e,a);var a=t(e,i,r);return a}function o(e,i,r,o){o=n(e,o);var a=_.reduce(e,function(e,i){return e+i.width()},0);return a>i&&(o=t(e,i,r)),o}function a(t,n){var m=[],l=[],u=t.children(),d=n.width?n.width:t.width(),s=i(d);imagesPerRow=n.imagesPerRow?n.imagesPerRow:s.itemsPerColumn,n.margin=n.margin?n.margin:3,n.lastRow=n.lastRow?n.lastRow:"fullwidth";for(var g,w=0;w<u.length;w++){var f=$(u[w]);if(f.width()>0){if(m.push(f),f.css("margin",n.margin),m.length>=imagesPerRow||w==u.length-1){var c=w==u.length-1;l.push(m),c?"fullwidth"==n.lastRow?g=r(l[l.length-1],d,n.margin,s.maxHeight):"adjust"==n.lastRow&&o(l[l.length-1],d,n.margin,g):g=r(l[l.length-1],d,n.margin,s.maxHeight),g<s.maxHeight&&(m=[])}}else f.load(function(){a(h,e),$(this).addClass("imgloaded")})}}function m(e){for(var i=e.children(),t=0;t<i.length;t++){var n=$(i[t]);n.css("display","inline-block"),n.find("img").css("width","100%")}}function l(){!e.interruptSetup&&m(h),window.readyForGallerify?a(h,e):$(window).on("load",function(){a(h,e)}),$(window).resize(function(){a(h,e)})}var h=this;return e.interruptSetup=e.interruptSetup?e.interruptSetup:!1,e.width=e.width?e.width:void 0,e.imagesPerRow=e.imagesPerRow?e.imagesPerRow:void 0,e.margin=e.margin?e.margin:void 0,e.mode=e.mode?e.mode:"default",l(),h};